
R version 3.6.0 (2019-04-26) -- "Planting of a Tree"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-redhat-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ## For Continuous Outcomes
> # Load required libraries
> library(GxEprs)
> library(GCIM)
> # Set plink path
> plink_path <- "/data/alh-admzw/plink2"
> 
> # For quantitative traits, use corresponding functions
> a <- GWAS_quantitative(plink_path, "DummyData", "Qexp_disc.txt", "Qcov_disc.txt")
PLINK v2.00a6LM 64-bit Intel (4 May 2024)      www.cog-genomics.org/plink/2.0/
(C) 2005-2024 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /tmp/RtmpqTDlMf/Q_gwas.log.
Options in effect:
  --allow-no-sex
  --bfile DummyData
  --covar Qcov_disc.txt
  --glm interaction
  --out /tmp/RtmpqTDlMf/Q_gwas
  --parameters 1, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16
  --pheno Qexp_disc.txt
  --threads 20

Start time: Fri Sep 19 14:15:57 2025
Note: --allow-no-sex no longer has any effect.  (Missing-sex samples are
automatically excluded from association analysis when sex is a covariate, and
treated normally otherwise.)
1546526 MiB RAM detected, ~1511719 available; reserving 773263 MiB for main
workspace.
Using up to 20 threads (change this with --threads).
1000 samples (528 females, 472 males; 1000 founders) loaded from DummyData.fam.
918 variants loaded from DummyData.bim.
1 quantitative phenotype loaded (800 values).
Warning: Phenotype/covariate value in [-8, -9) or (-9, -10] present, when -9
is treated as missing.  Use --no-input-missing-phenotype to treat -9 as a
numeric value (missing values can be indicated by 'NA'), or
--neg9-pheno-really-missing to suppress this warning.
15 covariates loaded from Qcov_disc.txt.
Calculating allele frequencies... 0%done.
Warning: Excluding constant covariate 'COVAR2' from --glm.
--glm linear regression on phenotype 'PHENO1': 0%done.
Results written to /tmp/RtmpqTDlMf/Q_gwas.PHENO1.glm.linear .
End time: Fri Sep 19 14:15:57 2025
> b <- GWEIS_quantitative(plink_path, "DummyData", "Qphen_disc.txt", "Qexp_dis_cov.txt")
PLINK v2.00a6LM 64-bit Intel (4 May 2024)      www.cog-genomics.org/plink/2.0/
(C) 2005-2024 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /tmp/RtmpqTDlMf/Q_gweis.log.
Options in effect:
  --allow-no-sex
  --bfile DummyData
  --covar Qexp_dis_cov.txt
  --glm interaction
  --out /tmp/RtmpqTDlMf/Q_gweis
  --parameters 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18
  --pheno Qphen_disc.txt
  --threads 20

Start time: Fri Sep 19 14:15:57 2025
Note: --allow-no-sex no longer has any effect.  (Missing-sex samples are
automatically excluded from association analysis when sex is a covariate, and
treated normally otherwise.)
1546526 MiB RAM detected, ~1511706 available; reserving 773263 MiB for main
workspace.
Using up to 20 threads (change this with --threads).
1000 samples (528 females, 472 males; 1000 founders) loaded from DummyData.fam.
918 variants loaded from DummyData.bim.
1 quantitative phenotype loaded (800 values).
Warning: Phenotype/covariate value in [-8, -9) or (-9, -10] present, when -9
is treated as missing.  Use --no-input-missing-phenotype to treat -9 as a
numeric value (missing values can be indicated by 'NA'), or
--neg9-pheno-really-missing to suppress this warning.
16 covariates loaded from Qexp_dis_cov.txt.
Calculating allele frequencies... 0%done.
Warning: Excluding constant covariate 'COVAR2' from --glm.
--glm linear regression on phenotype 'PHENO1': 0%done.
Results written to /tmp/RtmpqTDlMf/Q_gweis.PHENO1.glm.linear .
End time: Fri Sep 19 14:15:57 2025
> 
> # Extract and compute PRS
> trd <- a[c("ID", "A1", "BETA")]
> add <- b[c("ID", "A1", "ADD_BETA")]
> gxe <- b[c("ID", "A1", "INTERACTION_BETA")]
> 
> q <- PRS_quantitative(plink_path, "DummyData", summary_input = add)
PLINK v2.00a6LM 64-bit Intel (4 May 2024)      www.cog-genomics.org/plink/2.0/
(C) 2005-2024 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /tmp/RtmpqTDlMf/prs.log.
Options in effect:
  --bfile DummyData
  --out /tmp/RtmpqTDlMf/prs
  --score /tmp/RtmpqTDlMf/summary_stats 1 2 3 header

Start time: Fri Sep 19 14:15:58 2025
1546526 MiB RAM detected, ~1511690 available; reserving 773263 MiB for main
workspace.
Using up to 80 threads (change this with --threads).
1000 samples (528 females, 472 males; 1000 founders) loaded from DummyData.fam.
918 variants loaded from DummyData.bim.
Note: No phenotype data present.
Calculating allele frequencies... 0%done.
--score: 918 variants processed.
--score: Results written to /tmp/RtmpqTDlMf/prs.sscore .
End time: Fri Sep 19 14:15:58 2025
> write.table(q, "add_prs.txt", row.names=F, quote = F, sep = "\t")
> r <- PRS_quantitative(plink_path, "DummyData", summary_input = gxe)
PLINK v2.00a6LM 64-bit Intel (4 May 2024)      www.cog-genomics.org/plink/2.0/
(C) 2005-2024 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /tmp/RtmpqTDlMf/prs.log.
Options in effect:
  --bfile DummyData
  --out /tmp/RtmpqTDlMf/prs
  --score /tmp/RtmpqTDlMf/summary_stats 1 2 3 header

Start time: Fri Sep 19 14:15:58 2025
1546526 MiB RAM detected, ~1511688 available; reserving 773263 MiB for main
workspace.
Using up to 80 threads (change this with --threads).
1000 samples (528 females, 472 males; 1000 founders) loaded from DummyData.fam.
918 variants loaded from DummyData.bim.
Note: No phenotype data present.
Calculating allele frequencies... 0%done.
--score: 918 variants processed.
--score: Results written to /tmp/RtmpqTDlMf/prs.sscore .
End time: Fri Sep 19 14:15:58 2025
> write.table(r, "int_prs.txt", row.names=F, quote = F, sep = "\t") 
> p <- PRS_quantitative(plink_path, "DummyData", summary_input = trd)
PLINK v2.00a6LM 64-bit Intel (4 May 2024)      www.cog-genomics.org/plink/2.0/
(C) 2005-2024 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /tmp/RtmpqTDlMf/prs.log.
Options in effect:
  --bfile DummyData
  --out /tmp/RtmpqTDlMf/prs
  --score /tmp/RtmpqTDlMf/summary_stats 1 2 3 header

Start time: Fri Sep 19 14:15:58 2025
1546526 MiB RAM detected, ~1511686 available; reserving 773263 MiB for main
workspace.
Using up to 80 threads (change this with --threads).
1000 samples (528 females, 472 males; 1000 founders) loaded from DummyData.fam.
918 variants loaded from DummyData.bim.
Note: No phenotype data present.
Calculating allele frequencies... 0%done.
--score: 918 variants processed.
--score: Results written to /tmp/RtmpqTDlMf/prs.sscore .
End time: Fri Sep 19 14:15:58 2025
> write.table(p, "cov_prs.txt", row.names=F, quote = F, sep = "\t")
> 
> 
> # # Step 4: Run GCIM analysis with automatic saving and scaling
>  result1 <- gcim_q0("Qphen_tar.txt", "Qexp_tar_cov.txt", 
+                   Add_PRS = q, Int_PRS = r, Cov_PRS = p)
Loading data files for quantitative outcome analysis...
Outcome summary: Mean = 27.101, SD = 4.751, Range = [17.778, 46.485]
Loading add PRS data...
Using provided data object with 1000 samples.
Loading int PRS data...
Using provided data object with 1000 samples.
Loading cov PRS data...
Using provided data object with 1000 samples.
Scaling PRS values (mean=0, sd=1)...
PRS data summary:
- Additive PRS:  1000  individuals
- Interaction PRS:  1000  individuals
- Covariate PRS:  1000  individuals
Saving PRS copies to standardized temporary files...
Merging data files by FID and IID...
Final dataset contains 200 observations with 21 variables.
Outcome summary after merging: Mean = 27.101, SD = 4.751
Fitting linear regression model...
Formula: Outcome ~ Add_PRS + Int_PRS + Covariate_Pheno + Int_PRS:Cov_PRS +      Conf_1 + Conf_2 + Conf_3 + Conf_4 + Conf_5 + Conf_6 + Conf_7 +      Conf_8 + Conf_9 + Conf_10 + Conf_11 + Conf_12 + Conf_13 +      Conf_14 
>  result2 <- gcim_q1("Qphen_tar.txt", "Qexp_tar_cov.txt", 
+                   Add_PRS = q, Int_PRS = r, Cov_PRS = p)
Loading data files for quantitative outcome analysis...
Outcome summary: Mean = 27.101, SD = 4.751, Range = [17.778, 46.485]
Loading add PRS data...
Using provided data object with 1000 samples.
Loading int PRS data...
Using provided data object with 1000 samples.
Loading cov PRS data...
Using provided data object with 1000 samples.
Scaling PRS values (mean=0, sd=1)...
PRS data summary:
- Additive PRS:  1000  individuals
- Interaction PRS:  1000  individuals
- Covariate PRS:  1000  individuals
Saving PRS copies to standardized temporary files...
Merging data files by FID and IID...
Final dataset contains 200 observations with 21 variables.
Outcome summary after merging: Mean = 27.101, SD = 4.751
Fitting linear regression model...
Formula: Outcome ~ Add_PRS + Int_PRS + Covariate_Pheno + Cov_PRS + Int_PRS:Cov_PRS +      Conf_1 + Conf_2 + Conf_3 + Conf_4 + Conf_5 + Conf_6 + Conf_7 +      Conf_8 + Conf_9 + Conf_10 + Conf_11 + Conf_12 + Conf_13 +      Conf_14 
> 
>  # Step 5: Access results and processed PRS objects
>  print(result1$model_summary)

Call:
stats::lm(formula = model_formula, data = merged_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-9.3553 -3.3016 -0.2538  2.1435 18.9620 

Coefficients:
                Estimate Std. Error t value Pr(>|t|)    
(Intercept)     29.49287    3.67023   8.036 1.16e-13 ***
Add_PRS         -0.24579    0.36534  -0.673   0.5020    
Int_PRS         -0.07551    0.40504  -0.186   0.8523    
Covariate_Pheno -0.06776    0.36531  -0.185   0.8530    
Conf_1          -0.31764    0.13158  -2.414   0.0168 *  
Conf_2          -0.03142    0.04157  -0.756   0.4508    
Conf_3           0.20054    0.23651   0.848   0.3976    
Conf_4           0.38412    0.22684   1.693   0.0921 .  
Conf_5          -0.38324    0.22064  -1.737   0.0841 .  
Conf_6          -0.13732    0.15675  -0.876   0.3822    
Conf_7           0.09351    0.06991   1.338   0.1827    
Conf_8          -0.21469    0.22684  -0.946   0.3452    
Conf_9          -0.29007    0.21864  -1.327   0.1863    
Conf_10         -0.19900    0.18631  -1.068   0.2869    
Conf_11         -0.01685    0.08666  -0.194   0.8460    
Conf_12          0.06352    0.18782   0.338   0.7356    
Conf_13          2.11258    0.67700   3.120   0.0021 ** 
Conf_14         -0.11187    0.06992  -1.600   0.1114    
Int_PRS:Cov_PRS  0.13736    0.43681   0.314   0.7535    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 4.623 on 181 degrees of freedom
Multiple R-squared:  0.1386,	Adjusted R-squared:  0.05298 
F-statistic: 1.618 on 18 and 181 DF,  p-value: 0.05934

>  print(result2$model_summary)

Call:
stats::lm(formula = model_formula, data = merged_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-9.3922 -3.0179 -0.2094  1.8224 17.9065 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)    
(Intercept)     28.183064   3.697016   7.623 1.37e-12 ***
Add_PRS         -0.309242   0.363647  -0.850  0.39624    
Int_PRS         -0.128224   0.402497  -0.319  0.75042    
Covariate_Pheno -0.008428   0.363450  -0.023  0.98152    
Cov_PRS         -0.818939   0.406068  -2.017  0.04521 *  
Conf_1          -0.348675   0.131386  -2.654  0.00867 ** 
Conf_2          -0.022893   0.041440  -0.552  0.58133    
Conf_3           0.197041   0.234542   0.840  0.40196    
Conf_4           0.451173   0.227383   1.984  0.04875 *  
Conf_5          -0.386661   0.218801  -1.767  0.07889 .  
Conf_6          -0.102698   0.156388  -0.657  0.51222    
Conf_7           0.091554   0.069332   1.321  0.18834    
Conf_8          -0.174943   0.225807  -0.775  0.43951    
Conf_9          -0.245376   0.217937  -1.126  0.26170    
Conf_10         -0.243769   0.186078  -1.310  0.19185    
Conf_11         -0.015397   0.085936  -0.179  0.85800    
Conf_12          0.039447   0.186630   0.211  0.83284    
Conf_13          2.168696   0.671913   3.228  0.00148 ** 
Conf_14         -0.088428   0.070307  -1.258  0.21011    
Int_PRS:Cov_PRS  0.048590   0.435383   0.112  0.91126    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 4.585 on 180 degrees of freedom
Multiple R-squared:  0.1577,	Adjusted R-squared:  0.06876 
F-statistic: 1.773 on 19 and 180 DF,  p-value: 0.02883

> ###############################################
>  cat("Sample size:", result1$sample_size, "\n")
Sample size: 200 
>  cat("R-squared:", result1$r_squared, "\n")
R-squared: 0.1386407 
>  cat("Adjusted R-squared:", result1$adj_r_squared, "\n")
Adjusted R-squared: 0.05298061 
>  cat("Residual standard error:", result1$residual_se, "\n")
Residual standard error: 4.623229 
>  cat("F-statistic:", result1$f_statistic[1], "on", result1$f_statistic[2], "and", result1$f_statistic[3], "DF\n")
F-statistic: 1.618498 on 18 and 181 DF
>  cat("AIC:", result1$aic, "\n")
AIC: 
>  cat("BIC:", result1$bic, "\n")
BIC: 
>  
> 
> proc.time()
   user  system elapsed 
  1.091   0.419   0.853 

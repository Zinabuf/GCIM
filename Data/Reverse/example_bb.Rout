
R version 3.6.0 (2019-04-26) -- "Planting of a Tree"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-redhat-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ## Complete Workflow Example
> # Load required libraries
> library(GxEprs)
> library(GCIM)
> # Set plink path
> plink_path <- "/data/alh-admzw/plink2"
> # Step 1: Run GxEprs analysis for binary traits
> a <- GWAS_binary(plink_path, "DummyData", "Bphen_disc.txt", "Bcov_disc.txt")
PLINK v2.00a6LM 64-bit Intel (4 May 2024)      www.cog-genomics.org/plink/2.0/
(C) 2005-2024 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /tmp/Rtmp7jK12D/B_gwas.log.
Options in effect:
  --allow-no-sex
  --bfile DummyData
  --covar Bcov_disc.txt
  --glm
  --out /tmp/Rtmp7jK12D/B_gwas
  --parameters 1, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16
  --pheno Bphen_disc.txt
  --threads 20

Start time: Fri Sep 19 14:42:33 2025
Note: --allow-no-sex no longer has any effect.  (Missing-sex samples are
automatically excluded from association analysis when sex is a covariate, and
treated normally otherwise.)
1546526 MiB RAM detected, ~1511715 available; reserving 773263 MiB for main
workspace.
Using up to 20 threads (change this with --threads).
1000 samples (528 females, 472 males; 1000 founders) loaded from DummyData.fam.
918 variants loaded from DummyData.bim.
1 binary phenotype loaded (34 cases, 766 controls).
Warning: Phenotype/covariate value in [-8, -9) or (-9, -10] present, when -9
is treated as missing.  Use --no-input-missing-phenotype to treat -9 as a
numeric value (missing values can be indicated by 'NA'), or
--neg9-pheno-really-missing to suppress this warning.
15 covariates loaded from Bcov_disc.txt.
Calculating allele frequencies... 0%done.
Warning: Excluding constant covariate 'COVAR2' from --glm.
Warning: --glm remaining case count is less than 10x predictor count for
phenotype 'PHENO1'.
--glm logistic-Firth hybrid regression on phenotype 'PHENO1': 0%done.
Results written to /tmp/Rtmp7jK12D/B_gwas.PHENO1.glm.logistic.hybrid .
End time: Fri Sep 19 14:42:34 2025
> b <- GWEIS_binary(plink_path, "DummyData", "Bexp_disc.txt", "Bphen_disc_cov.txt")
PLINK v2.00a6LM 64-bit Intel (4 May 2024)      www.cog-genomics.org/plink/2.0/
(C) 2005-2024 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /tmp/Rtmp7jK12D/B_gweis.log.
Options in effect:
  --allow-no-sex
  --bfile DummyData
  --covar Bphen_disc_cov.txt
  --glm interaction
  --out /tmp/Rtmp7jK12D/B_gweis
  --parameters 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18
  --pheno Bexp_disc.txt
  --threads 20

Start time: Fri Sep 19 14:42:34 2025
Note: --allow-no-sex no longer has any effect.  (Missing-sex samples are
automatically excluded from association analysis when sex is a covariate, and
treated normally otherwise.)
1546526 MiB RAM detected, ~1511702 available; reserving 773263 MiB for main
workspace.
Using up to 20 threads (change this with --threads).
1000 samples (528 females, 472 males; 1000 founders) loaded from DummyData.fam.
918 variants loaded from DummyData.bim.
1 binary phenotype loaded (410 cases, 390 controls).
Warning: Phenotype/covariate value in [-8, -9) or (-9, -10] present, when -9
is treated as missing.  Use --no-input-missing-phenotype to treat -9 as a
numeric value (missing values can be indicated by 'NA'), or
--neg9-pheno-really-missing to suppress this warning.
16 covariates loaded from Bphen_disc_cov.txt.
Calculating allele frequencies... 0%done.
Warning: Excluding constant covariate 'COVAR2' from --glm.
--glm logistic-Firth hybrid regression on phenotype 'PHENO1': 0%done.
Results written to /tmp/Rtmp7jK12D/B_gweis.PHENO1.glm.logistic.hybrid .
End time: Fri Sep 19 14:42:34 2025
> 
> # Step 2: Extract summary statistics
> trd <- a[c("ID", "A1", "BETA")]
> add <- b[c("ID", "A1", "ADD_BETA")]
> gxe <- b[c("ID", "A1", "INTERACTION_BETA")]
> 
> # Step 3: Compute PRS for each component
> q <- PRS_binary(plink_path, "DummyData", summary_input = add)  # Additive PRS
PLINK v2.00a6LM 64-bit Intel (4 May 2024)      www.cog-genomics.org/plink/2.0/
(C) 2005-2024 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /tmp/Rtmp7jK12D/prs.log.
Options in effect:
  --bfile DummyData
  --out /tmp/Rtmp7jK12D/prs
  --score /tmp/Rtmp7jK12D/summary_stats 1 2 3 header

Start time: Fri Sep 19 14:42:34 2025
1546526 MiB RAM detected, ~1511687 available; reserving 773263 MiB for main
workspace.
Using up to 80 threads (change this with --threads).
1000 samples (528 females, 472 males; 1000 founders) loaded from DummyData.fam.
918 variants loaded from DummyData.bim.
Note: No phenotype data present.
Calculating allele frequencies... 0%done.
--score: 918 variants processed.
--score: Results written to /tmp/Rtmp7jK12D/prs.sscore .
End time: Fri Sep 19 14:42:34 2025
> r <- PRS_binary(plink_path, "DummyData", summary_input = gxe)  # Interaction PRS
PLINK v2.00a6LM 64-bit Intel (4 May 2024)      www.cog-genomics.org/plink/2.0/
(C) 2005-2024 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /tmp/Rtmp7jK12D/prs.log.
Options in effect:
  --bfile DummyData
  --out /tmp/Rtmp7jK12D/prs
  --score /tmp/Rtmp7jK12D/summary_stats 1 2 3 header

Start time: Fri Sep 19 14:42:34 2025
1546526 MiB RAM detected, ~1511685 available; reserving 773263 MiB for main
workspace.
Using up to 80 threads (change this with --threads).
1000 samples (528 females, 472 males; 1000 founders) loaded from DummyData.fam.
918 variants loaded from DummyData.bim.
Note: No phenotype data present.
Calculating allele frequencies... 0%done.
--score: 918 variants processed.
--score: Results written to /tmp/Rtmp7jK12D/prs.sscore .
End time: Fri Sep 19 14:42:34 2025
> p <- PRS_binary(plink_path, "DummyData", summary_input = trd)  # Covariate PRS
PLINK v2.00a6LM 64-bit Intel (4 May 2024)      www.cog-genomics.org/plink/2.0/
(C) 2005-2024 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /tmp/Rtmp7jK12D/prs.log.
Options in effect:
  --bfile DummyData
  --out /tmp/Rtmp7jK12D/prs
  --score /tmp/Rtmp7jK12D/summary_stats 1 2 3 header

Start time: Fri Sep 19 14:42:34 2025
1546526 MiB RAM detected, ~1511685 available; reserving 773263 MiB for main
workspace.
Using up to 80 threads (change this with --threads).
1000 samples (528 females, 472 males; 1000 founders) loaded from DummyData.fam.
918 variants loaded from DummyData.bim.
Note: No phenotype data present.
Calculating allele frequencies... 0%done.
--score: 918 variants processed.
--score: Results written to /tmp/Rtmp7jK12D/prs.sscore .
End time: Fri Sep 19 14:42:34 2025
> 
> # Step 4: Run GCIM analysis with automatic saving and scaling
>  result0 <- gcim_b0("Bexp_tar.txt", "Bphen_tar_cov.txt", 
+                   Add_PRS = q, Int_PRS = r, Cov_PRS = p) 
Loading data files for binary outcome analysis...
Loading add PRS data...
Using provided data object with 1000 samples.
Loading int PRS data...
Using provided data object with 1000 samples.
Loading cov PRS data...
Using provided data object with 1000 samples.
Scaling PRS values (mean=0, sd=1)...
PRS data summary:
- Additive PRS:  1000  individuals
- Interaction PRS:  1000  individuals
- Covariate PRS:  1000  individuals
Saving PRS copies to standardized temporary files...
Merging data files by FID and IID...
Final dataset contains 200 observations (85 cases, 115 controls) with 21 variables.
Fitting logistic regression model...
Formula: Outcome ~ Add_PRS + Int_PRS + Covariate_Pheno + Int_PRS:Cov_PRS +      Conf_1 + Conf_2 + Conf_3 + Conf_4 + Conf_5 + Conf_6 + Conf_7 +      Conf_8 + Conf_9 + Conf_10 + Conf_11 + Conf_12 + Conf_13 +      Conf_14 
>  result1 <- gcim_b1("Bexp_tar.txt", "Bphen_tar_cov.txt", 
+                   Add_PRS = q, Int_PRS = r, Cov_PRS = p) 
Loading data files for binary outcome analysis...
Loading add PRS data...
Using provided data object with 1000 samples.
Loading int PRS data...
Using provided data object with 1000 samples.
Loading cov PRS data...
Using provided data object with 1000 samples.
Scaling PRS values (mean=0, sd=1)...
PRS data summary:
- Additive PRS:  1000  individuals
- Interaction PRS:  1000  individuals
- Covariate PRS:  1000  individuals
Saving PRS copies to standardized temporary files...
Merging data files by FID and IID...
Final dataset contains 200 observations (85 cases, 115 controls) with 21 variables.
Fitting logistic regression model...
Formula: Outcome ~ Add_PRS + Int_PRS + Covariate_Pheno + Cov_PRS + Int_PRS:Cov_PRS +      Conf_1 + Conf_2 + Conf_3 + Conf_4 + Conf_5 + Conf_6 + Conf_7 +      Conf_8 + Conf_9 + Conf_10 + Conf_11 + Conf_12 + Conf_13 +      Conf_14 
> # # Step 5: Access results and processed PRS objects
>  print(result0$model_summary)

Call:
stats::glm(formula = model_formula, family = stats::binomial(link = "logit"), 
    data = merged_data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.0836  -0.9736  -0.6530   1.1154   1.9337  

Coefficients:
                Estimate Std. Error z value Pr(>|z|)  
(Intercept)     -2.15504    1.77273  -1.216   0.2241  
Add_PRS         -0.79887    2.16210  -0.369   0.7118  
Int_PRS         -0.84045    2.16549  -0.388   0.6979  
Covariate_Pheno  1.10360    0.60707   1.818   0.0691 .
Conf_1           0.43929    0.17249   2.547   0.0109 *
Conf_2           0.02223    0.05768   0.385   0.7000  
Conf_3          -0.01043    0.01912  -0.545   0.5855  
Conf_4          -0.14278    0.10755  -1.328   0.1843  
Conf_5          -0.03901    0.12087  -0.323   0.7469  
Conf_6           0.21100    0.10492   2.011   0.0443 *
Conf_7           0.13188    0.07649   1.724   0.0847 .
Conf_8          -0.07270    0.03654  -1.989   0.0467 *
Conf_9           0.10132    0.09965   1.017   0.3093  
Conf_10         -0.06678    0.08637  -0.773   0.4394  
Conf_11          0.07058    0.08797   0.802   0.4224  
Conf_12          0.02523    0.03854   0.655   0.5128  
Conf_13          0.04371    0.08038   0.544   0.5866  
Conf_14          0.06193    0.03233   1.916   0.0554 .
Int_PRS:Cov_PRS -0.19612    0.21426  -0.915   0.3600  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 272.74  on 199  degrees of freedom
Residual deviance: 247.09  on 181  degrees of freedom
AIC: 285.09

Number of Fisher Scoring iterations: 4

>  print(result1$model_summary)

Call:
stats::glm(formula = model_formula, family = stats::binomial(link = "logit"), 
    data = merged_data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.0850  -0.9675  -0.6351   1.0966   1.9845  

Coefficients:
                Estimate Std. Error z value Pr(>|z|)   
(Intercept)     -2.18536    1.77590  -1.231  0.21849   
Add_PRS         -0.34828    2.20551  -0.158  0.87453   
Int_PRS         -0.36859    2.21227  -0.167  0.86767   
Covariate_Pheno  1.13945    0.60866   1.872  0.06120 . 
Cov_PRS          0.21365    0.20429   1.046  0.29564   
Conf_1           0.47260    0.17655   2.677  0.00743 **
Conf_2           0.01861    0.05793   0.321  0.74808   
Conf_3          -0.01149    0.01923  -0.597  0.55038   
Conf_4          -0.14663    0.10768  -1.362  0.17331   
Conf_5          -0.05436    0.12226  -0.445  0.65659   
Conf_6           0.20299    0.10557   1.923  0.05449 . 
Conf_7           0.12855    0.07670   1.676  0.09373 . 
Conf_8          -0.07362    0.03664  -2.009  0.04451 * 
Conf_9           0.08664    0.10133   0.855  0.39253   
Conf_10         -0.06484    0.08645  -0.750  0.45327   
Conf_11          0.07843    0.08845   0.887  0.37525   
Conf_12          0.02261    0.03885   0.582  0.56055   
Conf_13          0.04201    0.08100   0.519  0.60398   
Conf_14          0.06619    0.03271   2.023  0.04306 * 
Int_PRS:Cov_PRS -0.19497    0.21664  -0.900  0.36815   
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 272.74  on 199  degrees of freedom
Residual deviance: 245.99  on 180  degrees of freedom
AIC: 285.99

Number of Fisher Scoring iterations: 4

>  cat("Sample size:", result0$sample_size, "\n")
Sample size: 200 
>  cat("Pseudo R-squared:", result0$pseudo_r_squared, "\n")
Pseudo R-squared: 0.09404691 
>  cat("AIC:", result0$aic, "\n")
AIC: 285.0913 
> # 
>  # Access the processed PRS objects
>  #head(result$add_prs)  # Processed and scaled additive PRS
>  #head(result$int_prs)  # Processed and scaled interaction PRS
>  #head(result$cov_prs)  # Processed and scaled covariate PRS
>  
>  # Check temporary files information
>  #if(result$temp_files_saved) {
>    #cat("Temporary directory used:", result$temp_dir, "\n")
>    #cat("Temporary files created:", paste(result$temp_files, collapse = ", "), "\n")
> # }
> # Select rows where the third column is NA
> na_rows <- add[is.na(add[, 3]), ]
> #/data/alh-admzw/plink2 --bfile dummydata --exclude bb.txt --make-bed --out DummyData
> 
> proc.time()
   user  system elapsed 
  1.608   0.363   0.799 

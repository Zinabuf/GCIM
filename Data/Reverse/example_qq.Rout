
R version 3.6.0 (2019-04-26) -- "Planting of a Tree"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-redhat-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ## For Continuous Outcomes
> # Load required libraries
> library(GxEprs)
> library(GCIM)
> # Set plink path
> plink_path <- "/data/alh-admzw/plink2"
> 
> # For quantitative traits, use corresponding functions
> a <- GWAS_quantitative(plink_path, "DummyData", "Qphen_disc.txt", "Qcov_disc.txt")
PLINK v2.00a6LM 64-bit Intel (4 May 2024)      www.cog-genomics.org/plink/2.0/
(C) 2005-2024 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /tmp/RtmpnC1RVr/Q_gwas.log.
Options in effect:
  --allow-no-sex
  --bfile DummyData
  --covar Qcov_disc.txt
  --glm interaction
  --out /tmp/RtmpnC1RVr/Q_gwas
  --parameters 1, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16
  --pheno Qphen_disc.txt
  --threads 20

Start time: Tue Sep 16 08:45:48 2025
Note: --allow-no-sex no longer has any effect.  (Missing-sex samples are
automatically excluded from association analysis when sex is a covariate, and
treated normally otherwise.)
1546526 MiB RAM detected, ~1511785 available; reserving 773263 MiB for main
workspace.
Using up to 20 threads (change this with --threads).
1000 samples (528 females, 472 males; 1000 founders) loaded from DummyData.fam.
918 variants loaded from DummyData.bim.
1 quantitative phenotype loaded (800 values).
Warning: Phenotype/covariate value in [-8, -9) or (-9, -10] present, when -9
is treated as missing.  Use --no-input-missing-phenotype to treat -9 as a
numeric value (missing values can be indicated by 'NA'), or
--neg9-pheno-really-missing to suppress this warning.
15 covariates loaded from Qcov_disc.txt.
Calculating allele frequencies... 0%done.
--glm linear regression on phenotype 'PHENO1': 0%done.
Results written to /tmp/RtmpnC1RVr/Q_gwas.PHENO1.glm.linear .
End time: Tue Sep 16 08:45:48 2025
> b <- GWEIS_quantitative(plink_path, "DummyData", "Qexp_disc.txt", "Qphen_disc_cov.txt")
PLINK v2.00a6LM 64-bit Intel (4 May 2024)      www.cog-genomics.org/plink/2.0/
(C) 2005-2024 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /tmp/RtmpnC1RVr/Q_gweis.log.
Options in effect:
  --allow-no-sex
  --bfile DummyData
  --covar Qphen_disc_cov.txt
  --glm interaction
  --out /tmp/RtmpnC1RVr/Q_gweis
  --parameters 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18
  --pheno Qexp_disc.txt
  --threads 20

Start time: Tue Sep 16 08:45:48 2025
Note: --allow-no-sex no longer has any effect.  (Missing-sex samples are
automatically excluded from association analysis when sex is a covariate, and
treated normally otherwise.)
1546526 MiB RAM detected, ~1511774 available; reserving 773263 MiB for main
workspace.
Using up to 20 threads (change this with --threads).
1000 samples (528 females, 472 males; 1000 founders) loaded from DummyData.fam.
918 variants loaded from DummyData.bim.
1 quantitative phenotype loaded (800 values).
Warning: Phenotype/covariate value in [-8, -9) or (-9, -10] present, when -9
is treated as missing.  Use --no-input-missing-phenotype to treat -9 as a
numeric value (missing values can be indicated by 'NA'), or
--neg9-pheno-really-missing to suppress this warning.
16 covariates loaded from Qphen_disc_cov.txt.
Calculating allele frequencies... 0%done.
--glm linear regression on phenotype 'PHENO1': 0%done.
Results written to /tmp/RtmpnC1RVr/Q_gweis.PHENO1.glm.linear .
End time: Tue Sep 16 08:45:48 2025
> 
> # Extract and compute PRS
> trd <- a[c("ID", "A1", "BETA")]
> add <- b[c("ID", "A1", "ADD_BETA")]
> gxe <- b[c("ID", "A1", "INTERACTION_BETA")]
> 
> q <- PRS_quantitative(plink_path, "DummyData", summary_input = add)
PLINK v2.00a6LM 64-bit Intel (4 May 2024)      www.cog-genomics.org/plink/2.0/
(C) 2005-2024 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /tmp/RtmpnC1RVr/prs.log.
Options in effect:
  --bfile DummyData
  --out /tmp/RtmpnC1RVr/prs
  --score /tmp/RtmpnC1RVr/summary_stats 1 2 3 header

Start time: Tue Sep 16 08:45:48 2025
1546526 MiB RAM detected, ~1511760 available; reserving 773263 MiB for main
workspace.
Using up to 80 threads (change this with --threads).
1000 samples (528 females, 472 males; 1000 founders) loaded from DummyData.fam.
918 variants loaded from DummyData.bim.
Note: No phenotype data present.
Calculating allele frequencies... 0%done.
--score: 918 variants processed.
--score: Results written to /tmp/RtmpnC1RVr/prs.sscore .
End time: Tue Sep 16 08:45:48 2025
> r <- PRS_quantitative(plink_path, "DummyData", summary_input = gxe) 
PLINK v2.00a6LM 64-bit Intel (4 May 2024)      www.cog-genomics.org/plink/2.0/
(C) 2005-2024 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /tmp/RtmpnC1RVr/prs.log.
Options in effect:
  --bfile DummyData
  --out /tmp/RtmpnC1RVr/prs
  --score /tmp/RtmpnC1RVr/summary_stats 1 2 3 header

Start time: Tue Sep 16 08:45:48 2025
1546526 MiB RAM detected, ~1511758 available; reserving 773263 MiB for main
workspace.
Using up to 80 threads (change this with --threads).
1000 samples (528 females, 472 males; 1000 founders) loaded from DummyData.fam.
918 variants loaded from DummyData.bim.
Note: No phenotype data present.
Calculating allele frequencies... 0%done.
--score: 918 variants processed.
--score: Results written to /tmp/RtmpnC1RVr/prs.sscore .
End time: Tue Sep 16 08:45:48 2025
> p <- PRS_quantitative(plink_path, "DummyData", summary_input = trd)
PLINK v2.00a6LM 64-bit Intel (4 May 2024)      www.cog-genomics.org/plink/2.0/
(C) 2005-2024 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /tmp/RtmpnC1RVr/prs.log.
Options in effect:
  --bfile DummyData
  --out /tmp/RtmpnC1RVr/prs
  --score /tmp/RtmpnC1RVr/summary_stats 1 2 3 header

Start time: Tue Sep 16 08:45:48 2025
1546526 MiB RAM detected, ~1511756 available; reserving 773263 MiB for main
workspace.
Using up to 80 threads (change this with --threads).
1000 samples (528 females, 472 males; 1000 founders) loaded from DummyData.fam.
918 variants loaded from DummyData.bim.
Note: No phenotype data present.
Calculating allele frequencies... 0%done.
--score: 918 variants processed.
--score: Results written to /tmp/RtmpnC1RVr/prs.sscore .
End time: Tue Sep 16 08:45:48 2025
> 
> # # Step 4: Run GCIM analysis with automatic saving and scaling
>  result0 <- gcim_q0("Qexp_tar.txt", "Qphen_tar_cov.txt", 
+                   Add_PRS = q, Int_PRS = r, Cov_PRS = p)
Loading data files for quantitative outcome analysis...
Outcome summary: Mean = -0.156, SD = 0.930, Range = [-1.260, 2.437]
Loading add PRS data...
Using provided data object with 1000 samples.
Loading int PRS data...
Using provided data object with 1000 samples.
Loading cov PRS data...
Using provided data object with 1000 samples.
Scaling PRS values (mean=0, sd=1)...
PRS data summary:
- Additive PRS:  1000  individuals
- Interaction PRS:  1000  individuals
- Covariate PRS:  1000  individuals
Saving PRS copies to standardized temporary files...
Merging data files by FID and IID...
Final dataset contains 200 observations with 21 variables.
Outcome summary after merging: Mean = -0.156, SD = 0.930
Fitting linear regression model...
Formula: Outcome ~ Add_PRS + Int_PRS + Covariate_Pheno + Int_PRS:Cov_PRS +      Conf_1 + Conf_2 + Conf_3 + Conf_4 + Conf_5 + Conf_6 + Conf_7 +      Conf_8 + Conf_9 + Conf_10 + Conf_11 + Conf_12 + Conf_13 +      Conf_14 
>  result1 <- gcim_q1("Qexp_tar.txt", "Qphen_tar_cov.txt", 
+                   Add_PRS = q, Int_PRS = r, Cov_PRS = p)
Loading data files for quantitative outcome analysis...
Outcome summary: Mean = -0.156, SD = 0.930, Range = [-1.260, 2.437]
Loading add PRS data...
Using provided data object with 1000 samples.
Loading int PRS data...
Using provided data object with 1000 samples.
Loading cov PRS data...
Using provided data object with 1000 samples.
Scaling PRS values (mean=0, sd=1)...
PRS data summary:
- Additive PRS:  1000  individuals
- Interaction PRS:  1000  individuals
- Covariate PRS:  1000  individuals
Saving PRS copies to standardized temporary files...
Merging data files by FID and IID...
Final dataset contains 200 observations with 21 variables.
Outcome summary after merging: Mean = -0.156, SD = 0.930
Fitting linear regression model...
Formula: Outcome ~ Add_PRS + Int_PRS + Covariate_Pheno + Cov_PRS + Int_PRS:Cov_PRS +      Conf_1 + Conf_2 + Conf_3 + Conf_4 + Conf_5 + Conf_6 + Conf_7 +      Conf_8 + Conf_9 + Conf_10 + Conf_11 + Conf_12 + Conf_13 +      Conf_14 
> 
>  
>  # Step 5: Access results and processed PRS objects
>  print(result0$model_summary)

Call:
stats::lm(formula = model_formula, data = merged_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.4755 -0.6970 -0.1352  0.6131  2.5625 

Coefficients:
                 Estimate Std. Error t value Pr(>|t|)  
(Intercept)      0.195159   0.875936   0.223   0.8239  
Add_PRS          0.610907   0.658064   0.928   0.3545  
Int_PRS          0.492336   0.653793   0.753   0.4524  
Covariate_Pheno -0.002212   0.015268  -0.145   0.8850  
Conf_1           0.031820   0.027421   1.160   0.2474  
Conf_2          -0.006162   0.008459  -0.728   0.4673  
Conf_3          -0.032466   0.048163  -0.674   0.5011  
Conf_4          -0.049937   0.047016  -1.062   0.2896  
Conf_5           0.084571   0.044748   1.890   0.0604 .
Conf_6           0.022523   0.032114   0.701   0.4840  
Conf_7           0.001956   0.014289   0.137   0.8913  
Conf_8           0.017399   0.046414   0.375   0.7082  
Conf_9           0.047140   0.044522   1.059   0.2911  
Conf_10         -0.024813   0.038478  -0.645   0.5198  
Conf_11          0.012242   0.017624   0.695   0.4882  
Conf_12          0.013844   0.038325   0.361   0.7184  
Conf_13         -0.036297   0.141347  -0.257   0.7976  
Conf_14          0.002498   0.014581   0.171   0.8641  
Int_PRS:Cov_PRS  0.067951   0.082968   0.819   0.4139  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.9414 on 181 degrees of freedom
Multiple R-squared:  0.06849,	Adjusted R-squared:  -0.02415 
F-statistic: 0.7393 on 18 and 181 DF,  p-value: 0.7673

> 
>  print(result1$model_summary)

Call:
stats::lm(formula = model_formula, data = merged_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.5377 -0.6873 -0.1983  0.5294  2.5939 

Coefficients:
                  Estimate Std. Error t value Pr(>|t|)  
(Intercept)      0.0588418  0.8763433   0.067   0.9465  
Add_PRS          0.6821117  0.6567596   1.039   0.3004  
Int_PRS          0.5977589  0.6543250   0.914   0.3622  
Covariate_Pheno -0.0006245  0.0152351  -0.041   0.9673  
Cov_PRS          0.1214049  0.0759022   1.599   0.1115  
Conf_1           0.0320768  0.0273042   1.175   0.2416  
Conf_2          -0.0044078  0.0084943  -0.519   0.6045  
Conf_3          -0.0323717  0.0479567  -0.675   0.5005  
Conf_4          -0.0463334  0.0468689  -0.989   0.3242  
Conf_5           0.0856096  0.0445610   1.921   0.0563 .
Conf_6           0.0225979  0.0319764   0.707   0.4807  
Conf_7           0.0020233  0.0142275   0.142   0.8871  
Conf_8           0.0191299  0.0462282   0.414   0.6795  
Conf_9           0.0386541  0.0446481   0.866   0.3878  
Conf_10         -0.0236882  0.0383195  -0.618   0.5372  
Conf_11          0.0119143  0.0175498   0.679   0.4981  
Conf_12          0.0076775  0.0383555   0.200   0.8416  
Conf_13         -0.0582612  0.1414111  -0.412   0.6808  
Conf_14          0.0024458  0.0145183   0.168   0.8664  
Int_PRS:Cov_PRS  0.0546324  0.0830318   0.658   0.5114  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.9374 on 180 degrees of freedom
Multiple R-squared:  0.08154,	Adjusted R-squared:  -0.01541 
F-statistic: 0.8411 on 19 and 180 DF,  p-value: 0.6558

> 
>  cat("Sample size:", result$sample_size, "\n")
Error in cat("Sample size:", result$sample_size, "\n") : 
  object 'result' not found
Execution halted
